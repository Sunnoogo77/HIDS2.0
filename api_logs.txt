api-1  | INFO:     Will watch for changes in these directories: ['/app']
api-1  | INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
api-1  | INFO:     Started reloader process [1] using WatchFiles
api-1  | INFO:     Started server process [8]
api-1  | INFO:     Waiting for application startup.
api-1  | INFO:     Application startup complete.
api-1  | INFO:     172.19.0.1:56542 - "GET /docs HTTP/1.1" 200 OK
api-1  | INFO:     172.19.0.1:56542 - "GET /openapi.json HTTP/1.1" 200 OK
api-1  | INFO:     172.19.0.1:56542 - "GET /docs HTTP/1.1" 200 OK
api-1  | INFO:     172.19.0.1:56542 - "GET /openapi.json HTTP/1.1" 200 OK
api-1  | INFO:     172.19.0.1:59492 - "POST /api/users HTTP/1.1" 404 Not Found
api-1  | INFO:     172.19.0.1:39782 - "POST /api/monitoring/ips HTTP/1.1" 401 Unauthorized
api-1  | INFO:     172.19.0.1:49332 - "POST /api/login HTTP/1.1" 404 Not Found
api-1  | INFO:     172.19.0.1:50042 - "POST /api/auth/login HTTP/1.1" 200 OK
api-1  | INFO:     172.19.0.1:49846 - "POST /api/monitoring/files HTTP/1.1" 201 Created
api-1  | INFO:     172.19.0.1:44826 - "GET /api/monitoring/files HTTP/1.1" 200 OK
api-1  | INFO:     172.19.0.1:48468 - "GET /api/monitoring/files/1 HTTP/1.1" 404 Not Found
api-1  | INFO:     172.19.0.1:51370 - "GET /api/monitoring/files/2 HTTP/1.1" 200 OK
api-1  | INFO:     172.19.0.1:47820 - "PUT /api/monitoring/files/1 HTTP/1.1" 404 Not Found
api-1  | INFO:     172.19.0.1:44022 - "POST /api/monitoring/files/1 HTTP/1.1" 405 Method Not Allowed
api-1  | INFO:     172.19.0.1:60528 - "POST /api/monitoring/files HTTP/1.1" 201 Created
api-1  | INFO:     172.19.0.1:47344 - "PUT /api/monitoring/files/1 HTTP/1.1" 404 Not Found
api-1  | INFO:     172.19.0.1:45822 - "PUT /api/monitoring/files/5 HTTP/1.1" 200 OK
api-1  | INFO:     172.19.0.1:45728 - "DELETE /api/monitoring/files/5 HTTP/1.1" 204 No Content
api-1  | INFO:     172.19.0.1:53186 - "POST /api/monitoring/folders HTTP/1.1" 500 Internal Server Error
api-1  | ERROR:    Exception in ASGI application
api-1  | Traceback (most recent call last):
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context
api-1  |     self.dialect.do_execute(
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute
api-1  |     cursor.execute(statement, parameters)
api-1  | sqlite3.IntegrityError: UNIQUE constraint failed: monitored_folders.path
api-1  | 
api-1  | The above exception was the direct cause of the following exception:
api-1  | 
api-1  | Traceback (most recent call last):
api-1  |   File "/usr/local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
api-1  |     result = await app(  # type: ignore[func-returns-value]
api-1  |   File "/usr/local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
api-1  |     return await self.app(scope, receive, send)
api-1  |   File "/usr/local/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
api-1  |     await super().__call__(scope, receive, send)
api-1  |   File "/usr/local/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
api-1  |     await self.middleware_stack(scope, receive, send)
api-1  |   File "/usr/local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 187, in __call__
api-1  |     raise exc
api-1  |   File "/usr/local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
api-1  |     await self.app(scope, receive, _send)
api-1  |   File "/usr/local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
api-1  |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
api-1  |   File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
api-1  |     raise exc
api-1  |   File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
api-1  |     await app(scope, receive, sender)
api-1  |   File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
api-1  |     await self.middleware_stack(scope, receive, send)
api-1  |   File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
api-1  |     await route.handle(scope, receive, send)
api-1  |   File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
api-1  |     await self.app(scope, receive, send)
api-1  |   File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
api-1  |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
api-1  |   File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
api-1  |     raise exc
api-1  |   File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
api-1  |     await app(scope, receive, sender)
api-1  |   File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
api-1  |     response = await f(request)
api-1  |   File "/usr/local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
api-1  |     raw_response = await run_endpoint_function(
api-1  |   File "/usr/local/lib/python3.10/site-packages/fastapi/routing.py", line 214, in run_endpoint_function
api-1  |     return await run_in_threadpool(dependant.call, **values)
api-1  |   File "/usr/local/lib/python3.10/site-packages/starlette/concurrency.py", line 37, in run_in_threadpool
api-1  |     return await anyio.to_thread.run_sync(func)
api-1  |   File "/usr/local/lib/python3.10/site-packages/anyio/to_thread.py", line 56, in run_sync
api-1  |     return await get_async_backend().run_sync_in_worker_thread(
api-1  |   File "/usr/local/lib/python3.10/site-packages/anyio/_backends/_asyncio.py", line 2470, in run_sync_in_worker_thread
api-1  |     return await future
api-1  |   File "/usr/local/lib/python3.10/site-packages/anyio/_backends/_asyncio.py", line 967, in run
api-1  |     result = context.run(func, *args)
api-1  |   File "/app/app/api/monitoring.py", line 103, in add_folder_item
api-1  |     return create_folder_item(folder_in)
api-1  |   File "/app/app/services/monitoring_service.py", line 140, in create_folder_item
api-1  |     db.commit()
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
api-1  |     trans.commit(_to_root=True)
api-1  |   File "<string>", line 2, in commit
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
api-1  |     ret_value = fn(self, *arg, **kw)
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
api-1  |     self._prepare_impl()
api-1  |   File "<string>", line 2, in _prepare_impl
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
api-1  |     ret_value = fn(self, *arg, **kw)
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
api-1  |     self.session.flush()
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4345, in flush
api-1  |     self._flush(objects)
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4480, in _flush
api-1  |     with util.safe_reraise():
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
api-1  |     raise exc_value.with_traceback(exc_tb)
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4441, in _flush
api-1  |     flush_context.execute()
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
api-1  |     rec.execute(self)
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
api-1  |     util.preloaded.orm_persistence.save_obj(
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
api-1  |     _emit_insert_statements(
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 1233, in _emit_insert_statements
api-1  |     result = connection.execute(
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1415, in execute
api-1  |     return meth(
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
api-1  |     return connection._execute_clauseelement(
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1637, in _execute_clauseelement
api-1  |     ret = self._execute_context(
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1842, in _execute_context
api-1  |     return self._exec_single_context(
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1982, in _exec_single_context
api-1  |     self._handle_dbapi_exception(
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2351, in _handle_dbapi_exception
api-1  |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context
api-1  |     self.dialect.do_execute(
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute
api-1  |     cursor.execute(statement, parameters)
api-1  | sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: monitored_folders.path
api-1  | [SQL: INSERT INTO monitored_folders (path, frequency, status, updated_at) VALUES (?, ?, ?, ?) RETURNING id, created_at]
api-1  | [parameters: ('/var/log', 'daily', 'active', None)]
api-1  | (Background on this error at: https://sqlalche.me/e/20/gkpj)
api-1  | INFO:     172.19.0.1:46072 - "GET /api/monitoring/folders HTTP/1.1" 200 OK
api-1  | INFO:     172.19.0.1:39332 - "GET /api/monitoring/folders/1 HTTP/1.1" 200 OK
api-1  | INFO:     172.19.0.1:34844 - "PUT /api/monitoring/folders/1 HTTP/1.1" 200 OK
api-1  | INFO:     172.19.0.1:57886 - "DELETE /api/monitoring/folders/1 HTTP/1.1" 401 Unauthorized
api-1  | INFO:     172.19.0.1:50022 - "DELETE /api/monitoring/folders/1 HTTP/1.1" 204 No Content
api-1  | INFO:     172.19.0.1:56534 - "POST /api/monitoring/folders HTTP/1.1" 500 Internal Server Error
api-1  | ERROR:    Exception in ASGI application
api-1  | Traceback (most recent call last):
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context
api-1  |     self.dialect.do_execute(
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute
api-1  |     cursor.execute(statement, parameters)
api-1  | sqlite3.IntegrityError: UNIQUE constraint failed: monitored_folders.path
api-1  | 
api-1  | The above exception was the direct cause of the following exception:
api-1  | 
api-1  | Traceback (most recent call last):
api-1  |   File "/usr/local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
api-1  |     result = await app(  # type: ignore[func-returns-value]
api-1  |   File "/usr/local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
api-1  |     return await self.app(scope, receive, send)
api-1  |   File "/usr/local/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
api-1  |     await super().__call__(scope, receive, send)
api-1  |   File "/usr/local/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
api-1  |     await self.middleware_stack(scope, receive, send)
api-1  |   File "/usr/local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 187, in __call__
api-1  |     raise exc
api-1  |   File "/usr/local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
api-1  |     await self.app(scope, receive, _send)
api-1  |   File "/usr/local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
api-1  |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
api-1  |   File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
api-1  |     raise exc
api-1  |   File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
api-1  |     await app(scope, receive, sender)
api-1  |   File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
api-1  |     await self.middleware_stack(scope, receive, send)
api-1  |   File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
api-1  |     await route.handle(scope, receive, send)
api-1  |   File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
api-1  |     await self.app(scope, receive, send)
api-1  |   File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
api-1  |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
api-1  |   File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
api-1  |     raise exc
api-1  |   File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
api-1  |     await app(scope, receive, sender)
api-1  |   File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
api-1  |     response = await f(request)
api-1  |   File "/usr/local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
api-1  |     raw_response = await run_endpoint_function(
api-1  |   File "/usr/local/lib/python3.10/site-packages/fastapi/routing.py", line 214, in run_endpoint_function
api-1  |     return await run_in_threadpool(dependant.call, **values)
api-1  |   File "/usr/local/lib/python3.10/site-packages/starlette/concurrency.py", line 37, in run_in_threadpool
api-1  |     return await anyio.to_thread.run_sync(func)
api-1  |   File "/usr/local/lib/python3.10/site-packages/anyio/to_thread.py", line 56, in run_sync
api-1  |     return await get_async_backend().run_sync_in_worker_thread(
api-1  |   File "/usr/local/lib/python3.10/site-packages/anyio/_backends/_asyncio.py", line 2470, in run_sync_in_worker_thread
api-1  |     return await future
api-1  |   File "/usr/local/lib/python3.10/site-packages/anyio/_backends/_asyncio.py", line 967, in run
api-1  |     result = context.run(func, *args)
api-1  |   File "/app/app/api/monitoring.py", line 103, in add_folder_item
api-1  |     return create_folder_item(folder_in)
api-1  |   File "/app/app/services/monitoring_service.py", line 140, in create_folder_item
api-1  |     db.commit()
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
api-1  |     trans.commit(_to_root=True)
api-1  |   File "<string>", line 2, in commit
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
api-1  |     ret_value = fn(self, *arg, **kw)
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
api-1  |     self._prepare_impl()
api-1  |   File "<string>", line 2, in _prepare_impl
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
api-1  |     ret_value = fn(self, *arg, **kw)
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
api-1  |     self.session.flush()
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4345, in flush
api-1  |     self._flush(objects)
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4480, in _flush
api-1  |     with util.safe_reraise():
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
api-1  |     raise exc_value.with_traceback(exc_tb)
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4441, in _flush
api-1  |     flush_context.execute()
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
api-1  |     rec.execute(self)
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
api-1  |     util.preloaded.orm_persistence.save_obj(
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
api-1  |     _emit_insert_statements(
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 1233, in _emit_insert_statements
api-1  |     result = connection.execute(
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1415, in execute
api-1  |     return meth(
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
api-1  |     return connection._execute_clauseelement(
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1637, in _execute_clauseelement
api-1  |     ret = self._execute_context(
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1842, in _execute_context
api-1  |     return self._exec_single_context(
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1982, in _exec_single_context
api-1  |     self._handle_dbapi_exception(
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2351, in _handle_dbapi_exception
api-1  |     raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context
api-1  |     self.dialect.do_execute(
api-1  |   File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute
api-1  |     cursor.execute(statement, parameters)
api-1  | sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: monitored_folders.path
api-1  | [SQL: INSERT INTO monitored_folders (path, frequency, status, updated_at) VALUES (?, ?, ?, ?) RETURNING id, created_at]
api-1  | [parameters: ('/var/log', 'daily', 'active', None)]
api-1  | (Background on this error at: https://sqlalche.me/e/20/gkpj)
api-1  | INFO:     172.19.0.1:38036 - "POST /api/monitoring/ip HTTP/1.1" 404 Not Found
api-1  | INFO:     172.19.0.1:35346 - "GET /api/monitoring/ips HTTP/1.1" 200 OK
api-1  | INFO:     172.19.0.1:49034 - "GET /api/monitoring/ips/1 HTTP/1.1" 200 OK
api-1  | INFO:     172.19.0.1:41540 - "DELETE /api/monitoring/ips/1 HTTP/1.1" 204 No Content
api-1  | INFO:     172.19.0.1:44562 - "GET /api/users HTTP/1.1" 404 Not Found
api-1  | INFO:     172.19.0.1:58200 - "GET /api/users/1 HTTP/1.1" 404 Not Found
api-1  | INFO:     172.19.0.1:48976 - "POST /api/users HTTP/1.1" 404 Not Found
api-1  | INFO:     172.19.0.1:45018 - "PUT /api/users/2 HTTP/1.1" 404 Not Found
api-1  | INFO:     172.19.0.1:36296 - "PUT /api/users/2/password HTTP/1.1" 404 Not Found
api-1  | INFO:     172.19.0.1:51822 - "DELETE /api/users/2 HTTP/1.1" 404 Not Found
api-1  | INFO:     172.19.0.1:42700 - "DELETE /api/users/2 HTTP/1.1" 404 Not Found
api-1  | INFO:     172.19.0.1:33118 - "GET /docs HTTP/1.1" 200 OK
api-1  | INFO:     172.19.0.1:33118 - "GET /openapi.json HTTP/1.1" 200 OK
api-1  | INFO:     Shutting down
api-1  | INFO:     Waiting for application shutdown.
api-1  | INFO:     Application shutdown complete.
api-1  | INFO:     Finished server process [8]
api-1  | INFO:     Stopping reloader process [1]
